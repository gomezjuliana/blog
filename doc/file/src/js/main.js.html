<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/js/main.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/gomezjuliana/blog" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  </ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/js/main.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import &apos;../scss/app.scss&apos;;

let globalInfo;
let currentGist;

document.querySelector(&apos;.form__button&apos;).addEventListener(&apos;click&apos;, getData);
document.querySelector(&apos;.form&apos;).addEventListener(&apos;submit&apos;, (e) =&gt; {e.preventDefault(); getData();});

function cleanResults(){
	if (document.querySelector(&apos;.gist-container&apos;)){
		document.querySelectorAll(&apos;.gist-container&apos;).forEach(function(){
			document.querySelector(&apos;.results&apos;).removeChild(document.querySelector(&apos;.gist-container&apos;));
		});
	}
	if (document.querySelector(&apos;.gist-container--expanded&apos;)){
		document.querySelector(&apos;.results&apos;).removeChild(document.querySelector(&apos;.gist-container--expanded&apos;));
	}
}

function getData(){
	cleanResults();
	const username = document.querySelector(&apos;.form__username&apos;).value;
	fetch(&apos;https://api.github.com/users/&apos;+username+&apos;/gists&apos;)
		.then(response =&gt; response.json())
		.then(getBlurbInfo)
		.catch(() =&gt; alert(&apos;Oops! Something went wrong!&apos;)); 
}

function getBlurbInfo(data){
	globalInfo = data;
	const min = Math.min(data.length, 10);
	for (let x = 0; x&lt;min; x++){
		const titleKey = Object.keys(data[x].files)[0];
		fetch(data[x].files[titleKey].raw_url)
			.then(response =&gt; response.text())
			.then((blurbInfo) =&gt; {currentGist = x; printInfo(blurbInfo, data[x]);})
			.catch(() =&gt; alert(&apos;Oops! Something went wrong!&apos;));
	}	
}

function printInfo(blurbInfo, data){
	//create a div for each gist
	const gistContainer = document.createElement(&apos;div&apos;);
	gistContainer.classList.add(&apos;gist-container&apos;);
	document.querySelector(&apos;.results&apos;).appendChild(gistContainer);

	//create the title
	let titleSpan = document.createElement(&apos;span&apos;);
	titleSpan.classList.add(&apos;gist-container__title&apos;);
	let titleTextNode = document.createTextNode(Object.keys(data.files)[0]);
	titleSpan.appendChild(titleTextNode);
	gistContainer.appendChild(titleSpan);

	//create the blurb
	const blurbParagraph = document.createElement(&apos;p&apos;);
	blurbParagraph.classList.add(&apos;gist-container__blurb&apos;);
	const blurbContent = blurbInfo.slice(0, 101);
	const blurb = document.createTextNode(blurbContent);

	const elipsesSpan = document.createElement(&apos;span&apos;);
	elipsesSpan.classList.add(&apos;gist-container__blurb-elipses&apos;);
	const elipses = document.createTextNode(&apos;...&apos;);

	elipsesSpan.appendChild(elipses);
	blurbParagraph.appendChild(blurb);
	blurbParagraph.appendChild(elipsesSpan);
	gistContainer.appendChild(blurbParagraph);

	//create a button
	const seeMoreButton = document.createElement(&apos;button&apos;);
	seeMoreButton.classList.add(&apos;gist-container__button&apos;);
	seeMoreButton.classList.add(&apos;btn&apos;);
	let seeMoreButtonText = document.createTextNode(&apos;See more&apos;);
	seeMoreButton.appendChild(seeMoreButtonText);
	gistContainer.appendChild(seeMoreButton);
	seeMoreButton.addEventListener(&apos;click&apos;, (e) =&gt; openModule(e, blurbInfo, data));
}

function openModule(e, blurbInfo, data){
	cleanResults();
	const expandedBlurbContainer = document.createElement(&apos;div&apos;);
	expandedBlurbContainer.classList.add(&apos;gist-container--expanded&apos;);

	let titleSpan = document.createElement(&apos;span&apos;);
	titleSpan.classList.add(&apos;gist-container__title&apos;);
	let titleTextNode = document.createTextNode(Object.keys(data.files)[0]);
	titleSpan.appendChild(titleTextNode);
	expandedBlurbContainer.appendChild(titleSpan);

	let blurbParagraph = document.createElement(&apos;p&apos;);
	blurbParagraph.classList.add(&apos;gist-container__blurb&apos;);
	const blurbTextExpanded = document.createTextNode(blurbInfo);
	blurbParagraph.appendChild(blurbTextExpanded);

	expandedBlurbContainer.appendChild(blurbParagraph);
	
	document.querySelector(&apos;.results&apos;).appendChild(expandedBlurbContainer);

	let backButton = document.createElement(&apos;button&apos;);
	backButton.classList.add(&apos;gist-container__button&apos;);
	backButton.classList.add(&apos;btn&apos;);
	let buttonText = document.createTextNode(&apos;Back to results&apos;);
	backButton.appendChild(buttonText);

	backButton.addEventListener(&apos;click&apos;, getData);

	const previousButton = document.createElement(&apos;button&apos;);
	const previousButtonText = document.createTextNode(&apos;&lt;&lt;&apos;);
	previousButton.classList.add(&apos;gist-container__back-button&apos;);
	previousButton.classList.add(&apos;btn&apos;);
	previousButton.appendChild(previousButtonText);

	const nextButton = document.createElement(&apos;button&apos;);
	const nextButtonText = document.createTextNode(&apos;&gt;&gt;&apos;);
	nextButton.classList.add(&apos;gist-container__next-button&apos;);
	nextButton.classList.add(&apos;btn&apos;);
	nextButton.appendChild(nextButtonText);

	previousButton.addEventListener(&apos;click&apos;, (e) =&gt; openModule(e, blurbInfo, globalInfo[currentGist-1]));
	nextButton.addEventListener(&apos;click&apos;, (e) =&gt; openModule(e, blurbInfo, globalInfo[currentGist+1]));

	expandedBlurbContainer.appendChild(previousButton);
	expandedBlurbContainer.appendChild(backButton);
	expandedBlurbContainer.appendChild(nextButton);
}</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.2)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
